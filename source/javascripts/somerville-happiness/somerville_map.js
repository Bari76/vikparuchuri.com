$(document).ready(function() {
    var data = '[[-71.1242654032636, 42.40245773812875, "8.000000"], [-71.12312789417413, 42.40755174487374, "5.000000"], [-71.12294693665959, 42.40429550476518, "5.000000"], [-71.12331580506907, 42.403991441097965, "6.000000"], [-71.12305509200473, 42.401644438296856, "7.000000"], [-71.12046149862192, 42.402899349939176, "1.000000"], [-71.12095119822811, 42.40285359712801, "7.000000"], [-71.08857565218624, 42.39502627406275, "9.000000"], [-71.08495803148332, 42.39596555815388, "9.000000"], [-71.08818353898077, 42.39652293662763, "8.000000"], [-71.09460941161393, 42.39560814530908, "5.000000"], [-71.08902087091792, 42.39417465991529, "5.000000"], [-71.0866602517647, 42.395175312878756, "10.000000"], [-71.09790621110223, 42.38278527423962, "5.500000"], [-71.09010075174845, 42.378469664579974, "8.000000"], [-71.10057885121032, 42.3841197383327, "4.000000"], [-71.09974681933677, 42.38326085463343, "7.000000"], [-71.09724603257378, 42.382986285499676, "7.000000"], [-71.09636292043334, 42.38623756289643, "7.000000"], [-71.09811167388658, 42.384995657977356, "6.000000"], [-71.09319923351919, 42.383467611719034, "8.000000"], [-71.09235824908664, 42.38590939647806, "1.000000"], [-71.09574731304686, 42.38327409369875, "6.000000"], [-71.09298047851455, 42.381893583621675, "8.000000"], [-71.08400253843504, 42.38633606751884, "6.000000"], [-71.08566490797872, 42.38693848609016, "5.000000"], [-71.0861493582713, 42.38853500535174, "9.000000"], [-71.09006866811062, 42.38725085620853, "10.000000"], [-71.08923865071799, 42.38489042907194, "8.000000"], [-71.08123529659463, 42.3856192117449, "8.000000"], [-71.08762309935342, 42.38970303792375, "10.000000"], [-71.08380005597328, 42.382326672091224, "10.000000"], [-71.07950730874532, 42.38534136612577, "3.000000"], [-71.08427826722405, 42.3858776067995, "6.000000"], [-71.08477105692089, 42.38833126186455, "8.000000"], [-71.08156819540946, 42.386311399138144, "5.000000"], [-71.08463678041937, 42.38623575531673, "8.000000"], [-71.12709169214784, 42.40453782397129, "8.000000"], [-71.13060426029647, 42.41168427403874, "8.000000"], [-71.12789344708094, 42.41032434608869, "9.000000"], [-71.12934975252098, 42.39923622759838, "2.000000"], [-71.12865946240088, 42.40306250314553, "7.000000"], [-71.12810895198363, 42.40366649023346, "7.000000"], [-71.12710499984415, 42.413105250653125, "7.000000"], [-71.1282328841958, 42.41449274458215, "9.000000"], [-71.1214728522982, 42.39954393662707, "4.000000"], [-71.12472142651613, 42.396968947212805, "10.000000"], [-71.12566153104731, 42.403299119964544, "8.000000"], [-71.12555229481781, 42.398830078777316, "8.000000"], [-71.116323936351, 42.39150041534765, "6.000000"], [-71.12345312078477, 42.395626492453005, "8.000000"], [-71.11464576548823, 42.39228042171813, "8.000000"], [-71.11757231952862, 42.389698077984946, "8.000000"], [-71.11663055170781, 42.39245058648137, "6.000000"], [-71.12498060809774, 42.39855584958729, "9.000000"], [-71.1173866431757, 42.39574878708513, "9.000000"], [-71.1226810985323, 42.39960386352759, "9.000000"], [-71.11740749898354, 42.392904309473586, "9.000000"], [-71.11891849548373, 42.394719721452304, "9.000000"], [-71.12239001484647, 42.39747956400496, "7.000000"], [-71.1244862981546, 42.39566068844359, "8.000000"], [-71.12297237780787, 42.40059605792006, "10.000000"], [-71.11775396949147, 42.3905821702341, "9.000000"], [-71.1180354792158, 42.39334335961781, "7.000000"], [-71.12437627903626, 42.39366422809907, "10.000000"], [-71.12320217279405, 42.395706874390164, "8.000000"], [-71.11243226066263, 42.40008592202626, "7.000000"], [-71.11833038231046, 42.39985306964238, "5.000000"], [-71.11575082921279, 42.39757594650326, "6.000000"], [-71.1152538065677, 42.39941584085254, "8.000000"], [-71.1155729261245, 42.399493526332066, "7.000000"], [-71.11605634190686, 42.40064942796318, "8.000000"], [-71.11470159124677, 42.39701638936186, "7.000000"], [-71.10975033306133, 42.398387572000715, "8.000000"], [-71.1122074573192, 42.400171835859354, "7.000000"], [-71.11159313768246, 42.39542043124694, "8.000000"], [-71.1142568437049, 42.39637742280852, "9.000000"], [-71.11171096167462, 42.3937581741774, "9.000000"], [-71.10524631748525, 42.39453381641879, "8.000000"], [-71.10815801492116, 42.38962389206851, "5.000000"], [-71.10850283216654, 42.39101747229103, "8.000000"], [-71.10910089399627, 42.38945526176145, "8.000000"], [-71.10470990092796, 42.390841366267836, "10.000000"], [-71.10541592807641, 42.394752622550584, "8.000000"], [-71.10145612600505, 42.39129120171641, "9.000000"], [-71.10481700994988, 42.39472440272042, "9.000000"], [-71.10408620413523, 42.39775732130855, "9.000000"], [-71.1042372685704, 42.39642798811596, "10.000000"], [-71.10576628637209, 42.38895202412456, "10.000000"], [-71.11250120351582, 42.393482396526615, "8.000000"], [-71.11170406807943, 42.39463253038754, "10.000000"], [-71.10260794750432, 42.396960652827644, "10.000000"], [-71.09949853740164, 42.39057511712401, "7.000000"], [-71.09558041883334, 42.38924002797185, "10.000000"], [-71.09645546283046, 42.38890973612707, "5.000000"], [-71.09515696227348, 42.39011891303839, "1.000000"], [-71.09880001589518, 42.390695962007264, "8.000000"], [-71.09820133722053, 42.39184554436302, "7.000000"], [-71.09795375747889, 42.39146325563067, "7.000000"], [-71.0925780101165, 42.389781228943676, "9.500000"], [-71.09809089198296, 42.39262578582182, "7.000000"], [-71.09542483041372, 42.39291447915517, "7.000000"], [-71.09266929509587, 42.389474712667635, "10.000000"], [-71.0938172206806, 42.39238765955289, "10.000000"], [-71.09067039996103, 42.38920667043141, "10.000000"], [-71.09573855084236, 42.39451828022255, "9.000000"], [-71.08816571966793, 42.39073679840487, "6.000000"], [-71.0969201336324, 42.38871905935646, "8.000000"], [-71.11324063538527, 42.39071679652817, "3.000000"], [-71.11269119817821, 42.39015843034719, "8.000000"], [-71.115372328944, 42.3872919484013, "8.000000"], [-71.11546183334633, 42.3868265643552, "7.000000"], [-71.11515173615686, 42.389887061439744, "8.500000"], [-71.11817638901583, 42.391187186788, "9.000000"], [-71.11652745999162, 42.38704492573515, "5.000000"], [-71.11525892019725, 42.387083187793735, "8.000000"], [-71.10299341061025, 42.38589480885333, "10.000000"], [-71.1026148289802, 42.381905394319006, "9.000000"], [-71.10297384768883, 42.385863673874944, "8.000000"], [-71.11667619829919, 42.3852571725717, "5.000000"], [-71.1063610292525, 42.38556227836005, "8.000000"], [-71.1050640042201, 42.38173888043896, "1.000000"], [-71.10302663786815, 42.38254776187091, "9.000000"], [-71.10571781611429, 42.3865245495884, "6.000000"], [-71.10782605363772, 42.39033814976206, "7.000000"], [-71.10729798840802, 42.39014973413021, "9.000000"], [-71.10753136782648, 42.38514472320238, "10.000000"], [-71.10996532157563, 42.39130361693844, "7.000000"], [-71.11034858196246, 42.3871805607872, "10.000000"], [-71.10113038456764, 42.38391511227646, "6.000000"], [-71.09853186834381, 42.390068202364716, "9.000000"], [-71.09168822179576, 42.38318889799193, "8.000000"], [-71.0988706620259, 42.380109662917185, "10.000000"], [-71.10165578508392, 42.37809795602308, "9.000000"], [-71.10186489277717, 42.38059113419753, "10.000000"], [-71.10246644907689, 42.373391584560245, "7.000000"], [-71.1104923355188, 42.382897178809145, "7.000000"], [-71.0968064483126, 42.37273594008817, "9.000000"], [-71.09683166612248, 42.38099890631338, "7.000000"], [-71.1003777954133, 42.38009943358114, "8.000000"], [-71.1136762602526, 42.38413834098214, "10.000000"], [-71.0829028594676, 42.37366384578366, "6.000000"], [-71.10333077789336, 42.375257714512315, "9.000000"], [-71.107203717684, 42.37606307892579, "10.000000"], [-71.10208530920373, 42.37942949978776, "8.000000"], [-71.10696691296434, 42.378759564163055, "10.000000"], [-71.09964363025661, 42.37422402645159, "7.000000"], [-71.10161027334024, 42.38051175170587, "9.000000"], [-71.10311911870802, 42.377426403043415, "8.000000"], [-71.09897691861644, 42.38100214116867, "6.000000"], [-71.10876719977989, 42.38099178789391, "8.000000"], [-71.08593506360091, 42.38195951828701, "1.000000"]]';

    var json_data = JSON.parse(data);
    var map = L.map('somerville-map').setView([42.39225595227951, -71.10458789507587], 13);
    L.tileLayer('http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png', {
        attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
        subdomains: 'abcd',
        minZoom: 12,
        maxZoom: 17
    }).addTo(map);

    var rainbow = new Rainbow();
    rainbow.setSpectrum('red', 'yellow', 'green');
    rainbow.setNumberRange(0, 10);

    for(var i=0;i<json_data.length;i++){
        var jd = json_data[i];
        var lat = parseFloat(jd[1]);
        var long = parseFloat(jd[0]);

        var color = "#" + rainbow.colourAt(jd[2]);
        var circle = L.circle([lat, long], 50, {
            color: color,
            fillColor: color,
            fillOpacity: 0.7,
            fill: true
        }).addTo(map);
    }
});